(function(h){var i=io.connect(document.location.origin),f=h.getElementById("chat-msgs"),a=h.getElementById("new-msg"),g=document.title;function d(j){document.title=!j?g:g+" | "+j}function e(){var j=a.innerHTML.trim();if(!j){return}b(false);i.emit("msg",{text:j});a.innerHTML=""}function b(j){a.setAttribute("contenteditable",j);if(j){a.focus()}}a.onkeypress=a.onkeydown=function(j){if((j.which||j.keyCode)===13){e()}};b(false);i.on("registration-ok",function(j){d();b(true)});var c=function(j,k){f.innerHTML+=j.html;if(k){h.querySelector("#m_"+j.id+" .user").className+=" me"}f.scrollTop=f.scrollHeight};i.on("msg-ok",function(j){c(j,true);b(true)});i.on("new-msg",c);i.on("registration-fail",function(j){i.emit("registration",{username:prompt(j.text+" Choose an username")})});i.on("msg-fail",function(j){console.log(j)});i.on("username-lookup",function(j){if(j.username){d();b(true);a.focus()}else{i.emit("registration",{username:prompt("Choose an username")})}});i.on("registration-ok",function(){d();b(true);a.focus()});i.on("progression",function(j){d(j.text)})})(document);