(function(){var a=io.connect(document.location.origin),e=document.getElementById("chat-msgs"),d=document.getElementById("new-msg"),g=prompt("Username");function c(){var h=d.innerHTML.trim();if(!h){return}b(false);a.emit("msg",{text:h});d.innerHTML=""}function b(h){d.setAttribute("contenteditable",h);if(h){d.focus()}}d.onkeypress=d.onkeydown=function(h){if((h.which||h.keyCode)===13){c()}};a.on("registration-ok",function(h){b(true)});var f=function(h,i){e.innerHTML+=h.html;if(i){document.querySelector("#m_"+h.id+" .user").className+=" me"}};a.on("msg-ok",function(h){f(h,true);b(true)});a.on("new-msg",f);a.on("registration-fail",function(h){g=prompt(h.text+" Choose an username");a.emit("registration",{username:g})});a.on("msg-fail",function(h){console.log(h)});a.emit("registration",{username:g});d.focus()})();