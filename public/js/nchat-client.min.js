(function(f){var a=io.connect(document.location.origin),e=f.getElementById("chat-msgs"),d=f.getElementById("new-msg"),h=prompt("Username");function c(){var i=d.innerHTML.trim();if(!i){return}b(false);a.emit("msg",{text:i});d.innerHTML=""}function b(i){d.setAttribute("contenteditable",i);if(i){d.focus()}}d.onkeypress=d.onkeydown=function(i){if((i.which||i.keyCode)===13){c()}};a.on("registration-ok",function(i){b(true)});var g=function(i,j){e.innerHTML+=i.html;if(j){f.querySelector("#m_"+i.id+" .user").className+=" me"}e.scrollTop=e.scrollHeight};a.on("msg-ok",function(i){g(i,true);b(true)});a.on("new-msg",g);a.on("registration-fail",function(i){h=prompt(i.text+" Choose an username");a.emit("registration",{username:h})});a.on("msg-fail",function(i){console.log(i)});a.emit("registration",{username:h});d.focus()})(document);